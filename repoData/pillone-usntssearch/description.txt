## How to install NZBMegasearch + NGINX + GUNICORN

This document explains how to install NZBMegasearch for handling heavy traffic by combining with nginx and Gunicorn.


It has been heavily tested by large quantity of users in the last months.

Who need this?

* moderate to high traffic websites
* who wants an exact replica of mega.nzbx.co ;)

---

### Content

* STEP 0: Tools needed 
* STEP 1: Installation and configuration
* STEP 2: All systems ready

---

### STEP 0: Tools needed

A linux system. You also need:

* nginx and supervisord: `$ sudo apt-get install nginx supervisor`
* gunicorn: `$ sudo easy_install gunicorn`

---

### STEP 1: Installation and configuration

* Install NZBMegasearch (**not as root**) in `/opt/` (or wherever else) by:  
```
$ cd /opt/
$ git clone https://github.com/pillone
```
> This will produce `/opt/usntssearch/`

* All the example configuration files are with respect to that directory.

* Edit, if needed, and copy the nginx conf file: `$ sudo cp /opt/usntssearch/large_server/nginx.conf /etc/nginx/` 

* Edit the 'user' field in the files contained in: `/opt/usntssearch/large_server/supervisor/conf.d/*.conf`


* Depending on the expected traffic, change the parameter `-w 15` (number of concurrent workers) in `/opt/usntssearch/large_server/supervisor/conf.d/mega2.py`

* Copy the supervisor configuration: `$ sudo cp -r /opt/usntssearch/large_server/supervisor /etc`

* Remove the init.d file `$ sudo rm /etc/init.d/nginx`. Supervisor will take care of running and restarting all the services

---

### STEP 2: All systems ready!

* Generate a valid configuration for  NZBMegasearch:
```
$ cd /opt/usntssearch/NZBmegasearch
$ python mega2.py
``` 
> then visit `http://serveripaddress:5000` and configure it. Alternatively, you can use a `custom_params.ini` that you have already saved from a home install.

* This will start all the services:
```
$ sudo supervisorctl reread
$ sudo supervisorctl update
$ sudo supervisorctl restart all
```

* **THAT'S IT! You have successfully installed NZBMegasearch!**

`




Place custom configuration files for supervisor here. They
will be read after the main configuration file in
/etc/supervisor/supervisord.conf

## How to install NZBMegasearch for free on the cloud 

This document explains how to install NZBMegasearch on a freely available free cloud service.
For this task, we will use OpenShift, a cloud computing platform from Red Hat.

It is really very easy to install it by using the step-by-step instructions.

These are the advantages of a cloud-installed NZBMegasearch: 


* it is always online, no need to start it from your computer
* it is connected on a crazy fast network (less waiting time)
* it is free
* your configuration, your providers!
* it is SSL and password protected

Note: This kind of installation does not support heavy traffic/load. It is designed only for personal usage (or small groups).

---

### Content

* STEP 0: Tools needed 
* STEP 1: Register on Openshift
* STEP 2: Create your site on Openshift
* STEP 3: Install NZBMegasearch on the cloud
* STEP ??: Update NZBMegasearch (when updates are available :] )

---

### STEP 0: Tools needed

You only need to install:

* [Git and Rhc: step-by-step install  (Linux, Win, Mac)](https://www.openshift.com/developers/rhc-client-tools-install)
* a [SSH client](http://www.chiark.greenend.org.uk/~sgtatham/putty/) in case you are using Windows (Linux and Mac have it already installed by default)

---

### STEP 1: Register on Openshift

A valid email is required:

* *Register on Openshift*: [https://www.openshift.com/](https://www.openshift.com/)


---

### STEP 2: Create your site on Openshift 

* Go to console, make a folder, enter in it and type:
> `$ rhc app create flask python-2.7`  
> This will take few minutes. The tool will ask for a 'namespace', part of the domain name of your online install. E.g.: If you enter 'dog'. Your url on the cloud will be: `flask-dog.rhcloud.com`

* Continue on the console:
> ```
$ cd flask 
$ git remote add upstream -m master git://github.com/openshift/flask-example.git
$ git pull -s recursive -X theirs upstream master
$ git push
```

* You can now check out that everything has been correctly installed by opening with your browser:
> `http://flask-dog.rhcloud.com/`

---

### STEP 3: Install NZBMegasearch on the cloud

* Login in  [https://www.openshift.com/](https://www.openshift.com/)

* You will be presented with a list of installed applications. Click on 'Flask'. It should also visualize the domain you have created at STEP 3.

* On the page of the Flask application click on the link: `WANT TO LOG IN TO YOUR APPLICATION?`  

* Copy the line similar to this: `ssh 123456890123456890@flask-dog.rhcloud.com`.

* Issue the command:
> `$ ssh 12361287362187368713621@flask-dog.rhcloud.com` (if you are using Windows, put that as your url)

* If everything went fine, you are now logged in the Openshift cloud and you should be presented this kind of prompt:
> `[flask-dog.rhcloud.com 123456890123456890]\>`

* On the remote server prompt (shortened for visibility), type:
> ```
[flask-dog.rhcloud.com]\> cd app-root/repo/wsgi/
[flask-dog.rhcloud.com]\> git clone https://github.com/pillone/usntssearch.git
[flask-dog.rhcloud.com]\> cd usntssearch/NZBmegasearch/openshift
[flask-dog.rhcloud.com]\> ./install_openshift.sh
[flask-dog.rhcloud.com]\> ctl_app restart
```
then select 1 (python-2.7) to start 

* You can now check out that everything has been correctly installed by visiting:
> `http://flask-dog.rhcloud.com/`

* **The DEFAULT username and password are:**
> User: 'NZBMadmin'  
> Pwd: 'NZBMadmin'
> **... that I strongly suggest to change ;)**

* Configure all your options, as a standard NZBMegasearch install

* Disconnect from SSH and remove your directory `flask` on your hard drive

* **THAT'S IT! You have successfully installed NZBMegasearch on the cloud!**

---

### STEP ??: Update NZBMegasearch

* In case updates are available (via notification in NZBMegasearch), you need to:
> Log in: `ssh 12361287362187368713621@flask-dog.rhcloud.com` (if you are using Windows, put that as your url)

* and on the remote prompt:
>``` 
[flask-dog.rhcloud.com]\> cd app-root/repo/wsgi/usntssearch/NZBmegasearch/openshift
[flask-dog.rhcloud.com]\> ./install_openshift.sh
[flask-dog.rhcloud.com]\> ctl_app restart
```
then select 1 (python-2.7) to start 

* You can now disconnect from SSH

* **THAT'S IT! You have successfully updated NZBMegasearch!**



**NZBmegasearcH** 
======================

*Aggregate automatically NZB search results. Easy. Quick. Clean.*

NZBmegasearcH collects all your (not only) newznab-based accounts to one place. It is your meta-search engine and your SB, CP unique NZB provider.

## [Go to NZBmegasearcH website](http://pillone.github.io/usntssearch/)

A special thanks to **JackDandy, duckduckquack, Riz0** for beta-testing. 

Thanks to all the users that submitted a bug report or a enhancement request.

## Updates

**Changes in v0.46**

- Extended NZB analysis from search results, displays no. ARCHIVE,PAR2,NFO
- Smart category download
- Providers check in config
- Reverse proxy updates
- Bug fixes


More updates are available in changelog.txt

<a title="website statistics" href="http://statcounter.com/" 
target="_blank"><img
src="http://c.statcounter.com/8769563/0/45111251/0/" alt="website statistics" style="border:none;"></a>
 

